<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mainpage</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
    <style>
        body {
            background-color: #f0f4f7;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #495057;
            transition: all 0.3s ease;
            opacity: 0; /* 页面加载时初始透明 */
            transition: opacity 0.3s ease-in-out; /* 改快渐变效果 */
        }

        /* Navbar */
        .navbar {
            background-color: #343a40;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* 增加阴影 */
            padding: 15px 30px;
        }

        .navbar .nav-link {
            color: #fff !important;
            font-size: 1.1rem;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .navbar .nav-link.active {
            color: #ffc107 !important;
            transform: scale(1.1); /* 激活链接有轻微放大效果 */
        }

        .navbar .nav-link:hover {
            color: #ffc107 !important; /* 悬停时改变颜色 */
        }

        .navbar .nav-item + .nav-item {
            margin-left: 20px;
        }

        /* 侧边栏 */
        .sidebar {
            background-color: #ffffff;
            border-right: 1px solid #ddd;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            height: 100vh;
            padding-top: 30px;
            width: 300px;
            transition: all 0.3s ease;
        }

        .sidebar .nav-link {
            color: #495057;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 5px;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        .sidebar .nav-link:hover {
            background-color: #007bff;
            color: #fff;
            transform: scale(1.05);
        }

        .sidebar .user-info {
            text-align: center;
            margin-bottom: 30px;
            padding: 10px;
        }

        .sidebar .user-info img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 10px;
        }

        .sidebar .user-info strong {
            display: block;
            font-size: 1.1rem;
            color: #343a40;
            font-weight: bold;
        }

        /* 主内容 */
        .main-content {
            margin-left: 100px;
            padding: 30px;
            transition: margin-left 0.3s ease;
        }

        .card {
            margin-bottom: 20px;
            border-radius: 12px; /* 增加圆角 */
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            background-color: #ffffff;
        }

        .card-header {
            background-color: #343a40;
            color: #fff;
            font-size: 1.2rem;
            border-radius: 12px 12px 0 0;
        }

        .card:hover {
            transform: translateY(-8px); /* 更加细腻的悬浮效果 */
        }

        .dropdown-menu {
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .dropdown-item:hover {
            background-color: #f8f9fa;
        }

        .btn-custom {
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 6px; /* 增加圆角 */
            padding: 10px 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: background-color 0.2s ease, box-shadow 0.2s ease;
        }

        .btn-custom:hover {
            background-color: #0056b3;
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }

        /* 工具提示 */
        .sidebar .nav-link span {
            margin-left: 10px;
            font-size: 1rem;
        }

        /* 侧边栏内的链接 */
        .sidebar .nav-link {
            display: flex;
            align-items: center;
        }

        .sidebar .nav-link svg {
            width: 22px;
            height: 22px;
            fill: currentColor;
            margin-right: 15px;
        }

        /* 侧边栏底部按钮 */
        .sidebar .btn-custom {
            width: 100%;
            margin-bottom: 10px;
        }

        /* 文字动画 */
        .navbar a {
            font-weight: 500;
        }

        .main-content {
            font-size: 1rem;
            color: #343a40;
        }
    </style>
</head>
<body onload="fadeIn()">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
         integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
         crossorigin="anonymous"></script>

    {% if user.is_authenticated %}
    <div class="container-fluid">
        <!-- Navbar -->
        <header class="d-flex flex-wrap justify-content-between py-3 mb-4 border-bottom navbar">
            <a href="" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none" style="margin-left: 70px">
                <span class="fs-4 text-white">Music Website</span>
            </a>
            <ul class="nav nav-pills">
                <li class="nav-item"><a href="{% url 'mainpage:user_mainpage' %}" class="nav-link active" aria-current="page">Home</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Features</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Pricing</a></li>
                <li class="nav-item"><a href="#" class="nav-link">FAQs</a></li>
                <li class="nav-item"><a href="#" class="nav-link">About</a></li>
            </ul>
        </header>

        <div class="d-flex">
            <!-- Sidebar -->
            <div class="sidebar p-3">
                <div class="user-info">
                    <img src="{{ avatar.url|default:'/media/avatars/default.jpg' }}" alt="User Avatar" style="width:120px;height:120px">
                    <strong>{{ user.username|truncatechars:20 }}</strong>
                </div>
                <span class="fs-4 mb-3">Function Sidebar</span>
                <hr>
                <ul class="nav flex-column">
                    <li>
                        <a href="{% url 'user:flavorite' %}" class="nav-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-box2-heart-fill" viewBox="0 0 16 16">
                                <path d="M3.75 0a1 1 0 0 0-.8.4L.1 4.2a.5.5 0 0 0-.1.3V15a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V4.5a.5.5 0 0 0-.1-.3L13.05.4a1 1 0 0 0-.8-.4zM8.5 4h6l.5.667V5H1v-.333L1.5 4h6V1h1zM8 7.993c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132"/>
                            </svg>
                            <span>Favorite</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'user:likes' %}" class="nav-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                            </svg>
                            <span>Likes</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'user:management' %}" class="nav-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                                <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414zM0 4.697v7.104l5.803-3.558zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586zm3.436-.586L16 11.801V4.697z"/>
                            </svg>
                            <span>Management</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'user:friends' %}" class="nav-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-chat-heart-fill" viewBox="0 0 16 16">
                                <path d="M8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6-.097 1.016-.417 2.13-.771 2.966-.079.186.074.394.273.362 2.256-.37 3.597-.938 4.18-1.234A9 9 0 0 0 8 15m0-9.007c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132"/>
                            </svg><span>Friends</span>
                        </a>
                    </li>
                </ul>
                <hr>
                <div class="dropdown">
                    <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="{{ avatar.url }}" alt="User Avatar" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px">
                        <strong style="color:black">Setting</strong>
                    </a>
                    <ul class="dropdown-menu text-small shadow">
                        <li><a class="dropdown-item" href="{% url 'user:profile' %}">Profile</a></li>
                        <li><a class="dropdown-item" href="#">Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="{% url 'mainpage:sign_out' %}">Sign out</a></li>
                    </ul>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <br>
                {% block body1 %}{% endblock %}
            </div>
        </div>
    </div>
    {% else %}
    <div class="container-fluid">
        <!-- Navbar -->
        <header class="d-flex flex-wrap justify-content-between py-3 mb-4 border-bottom navbar">
            <a href="" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none" style="margin-left: 70px">
                <span class="fs-4 text-white">Music Website</span>
            </a>
            <ul class="nav nav-pills">
                <li class="nav-item"><a href="{% url 'mainpage:mainpage_template' %}" class="nav-link active" aria-current="page">Home</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Features</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Pricing</a></li>
                <li class="nav-item"><a href="#" class="nav-link">FAQs</a></li>
                <li class="nav-item"><a href="#" class="nav-link">About</a></li>
            </ul>
        </header>

        <div class="d-flex">
            <!-- Sidebar -->
            <div class="sidebar p-3" style="width: 280px; height: 100vh;">
                <span class="fs-4 mb-3">Function Sidebar</span>
                <hr>
                <p>Welcome to our music website. Please sign up or sign in to explore more.</p>
                <a href="{% url 'mainpage:sign_up' %}" class="btn btn-custom">Sign up</a>
                <a href="{% url 'mainpage:sign_in' %}" class="btn btn-custom">Sign in</a>
                <hr>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <br>
                {% block body2 %}{% endblock %}
            </div>
        </div>
    </div>
    {% endif %}

    <script>
        function fadeIn() {
            document.body.style.opacity = 1;
        }
    </script>
</body>
</html>
